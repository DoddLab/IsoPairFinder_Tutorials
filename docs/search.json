[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Tutorial of IsoPairFinder",
    "section": "",
    "text": "Abstract\nUnderstanding metabolic pathways in gut microbes is crucial for advancing microbiome research, yet identifying specific metabolic intermediates remains challenging due to the complexity of LC-MS data analysis. IsoPairFinder is a novel tool designed to streamline Stable Isotope Tracing (SIT) metabolomics from gene-edited microbes, enabling efficient identification of pathway intermediates and gene functions. IsoPairFinder offers an end-to-end workflow that: (1) Detects differential ion signals resulting from gene mutations; (2) Consolidates redundant LC-MS features (isotopes, adducts, fragments); (3) Pairs ¹²C/¹³C features to highlight candidate intermediates. Compatible with popular metabolomics data processing tools, IsoPairFinder empowers researchers to rapidly generate actionable biological insights. This tutorial provides step-by-step guidance for using IsoPairFinder.\nThe ways to access IsoPairFinder are listed below:\n\n\n\nAccess Method\nType\nLink\nDocument\n\n\n\n\nR Package\nCommand line tools\nLink\nDocumentation\n\n\nWeb Server\nGraphic interface within GNPS2 ecosystem\nLink\nDocumentation\n\n\n\n\nIf you used IsoPairFinder in your research, please cite the following paper:\n\nZhou, Z., et al., IsoPairFinder: A tool for biochemical pathway discovery using stable isotope tracing metabolomics, In preparation, 2025.\n\nFor questions, contact Zhiwei Zhou (Stanford University).",
    "crumbs": [
      "Abstract"
    ]
  },
  {
    "objectID": "quick_start.html",
    "href": "quick_start.html",
    "title": "1  Quick Start",
    "section": "",
    "text": "1.1 Installation\nTo install the IsoPairFinder package, you can use the following command in R:\n# intall public packages\nif (!require(devtools)){\n    install.packages(\"devtools\")\n}\n\nif (!require(BiocManager)){\n    install.packages(\"BiocManager\")\n}\n\n# Required packages\nrequired_pkgs &lt;- c(\"dplyr\",\"tidyr\",\"readr\", \"stringr\", \"tibble\", \"purrr\",\n                   \"ggplot2\", \"igraph\", \"pbapply\", \"Rdisop\", \"randomForest\", \"pryr\", \n                   \"magrittr\", \"rmarkdown\", \"caret\", \"writexl\", \"ggrepel\", \"crayon\", \n                   \"data.table\", \"mzR\", \"Rdisop\", \"grid\", \"gridExtra\", \"RaMS\", \"knitr\",\n                   \"rcdk\")\nBiocManager::install(required_pkgs)\ndevtools::install_github(\"JustinZZW/SpectraTools2\")\ndevtools::install_github(\"DoddLab/MassToolsMjhelf\")\n\n# install.packages(\"IsoPairFinder\")\ndevtools::install_github(\"DoddLab/IsoPairFinder\")",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Quick Start</span>"
    ]
  },
  {
    "objectID": "quick_start.html#demo-data",
    "href": "quick_start.html#demo-data",
    "title": "1  Quick Start",
    "section": "\n1.2 Demo data",
    "text": "1.2 Demo data\nThe demo data belong to the uric acid catabolism pathway study1. Briefly, we cultured wild-type and mutant strains (hyuA mutant in the demo data) of C. sporogenes in the presence of either unlabeled uric acid or its [13C5]-labeled isotopolog (detailed study design can be found Chapter 4).\nThe demo data can be downloaded here. The downloaded data contains below files (Figure 1.1). Please refer to Chapter 2 for the detailed requirements of the data format for the step-by-step data preparation (xcms - Section 2.1, msdial - Section 2.2, mzmine - Section 2.3).\n\n\n\n\n\nFigure 1.1: The screenshot of the demo data.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Quick Start</span>"
    ]
  },
  {
    "objectID": "quick_start.html#run-script",
    "href": "quick_start.html#run-script",
    "title": "1  Quick Start",
    "section": "\n1.3 Run script",
    "text": "1.3 Run script\nThe basic use of IsoPairFinder is simply running the R script as below:\n\n# run the IsoPairFinder workflow\nlibrary(tidyverse)\nlibrary(IsoPairFinder)\n\n# analysis of HyuA \nfind_intemidates(peak_table_unlabel = 'peak_table_C12.csv',\n                 peak_table_label = 'peak_table_C13.csv',\n                 sample_info = 'sample_info.csv',\n                 path = '~/Project/00_Uric_Acid_project/Data/20250606_isopairfind_test/Demo_data_msdial/',\n                 polarity = 'positive',\n                 control_group = c(\"WT\"),\n                 case_group = c('hyuA'),\n                 mz_tol = 10,\n                 rt_tol = 0.05,\n                 p_value_cutoff = 0.05,\n                 p_adjust = TRUE,\n                 fold_change_cutoff = 20,\n                 is_recognize_adducts = TRUE)\n\nPlease refer to Section 3.2 for the explains of parameters.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Quick Start</span>"
    ]
  },
  {
    "objectID": "quick_start.html#output",
    "href": "quick_start.html#output",
    "title": "1  Quick Start",
    "section": "\n1.4 Output",
    "text": "1.4 Output\nAfter running, a new folder “00_tracer_result” will be created. It contains several files, including “tracer_pair_result.xlsx” and several PDF files. In the tab of the XLSX file, we could find the identified ion pair results between the unlabeled and labeled groups (Figure 1.2). The detailed explanations of each file can be found in Section 3.3.\n\n\n\n\n\nFigure 1.2: Overview of results.\n\n\n\n\n\n\n1. \nLiu, Y. et al. A widely distributed gene cluster compensates for uricase loss in hominids. Cell 186, 3400–3413.e20 (2023).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Quick Start</span>"
    ]
  },
  {
    "objectID": "isoPairFinder_running.html",
    "href": "isoPairFinder_running.html",
    "title": "3  IsoPairFinder running",
    "section": "",
    "text": "3.1 Overview of the IsoPairFinder workflow\nGenerally, the IsoPairFinder processes the stable isotope tracing (STI) metabolomics data via 3 steps (Figure 3.1): (1) differential analysis; (2) recognition of adduct, neutral loss, and in-source fragment; (3) feature pairing between unlabeled and labeled data.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>IsoPairFinder running</span>"
    ]
  },
  {
    "objectID": "isoPairFinder_running.html#overview-of-the-isopairfinder-workflow",
    "href": "isoPairFinder_running.html#overview-of-the-isopairfinder-workflow",
    "title": "3  IsoPairFinder running",
    "section": "",
    "text": "Differential analysis: Identifying the possible accumulated substrates by comparing mutant and control groups. The unlabeled data and labeled data were processed respectively.\n\nMerging adduct, neutral losses, and in-source fragments: The potential substrate ions that were identified in the unlabeled data were used to retrieve and merge the related features (e.g., adduct, neutral losses, and in-source fragments) to avoid false positives. The extracted ion chromatography (EIC) of ions was also retrieved and checked.\n\nFeature pairing between unlabeled and labeled data: The reserved substrate ions of unlabeled data were used for chemical formula prediction and further confirming it by searching for pairing substrate ions in the labeled data.\n\n\n\n\n\n\nFigure 3.1: Overview of the IsoPairFinder workflow.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>IsoPairFinder running</span>"
    ]
  },
  {
    "objectID": "isoPairFinder_running.html#sec-isoPairFinder-parameters",
    "href": "isoPairFinder_running.html#sec-isoPairFinder-parameters",
    "title": "3  IsoPairFinder running",
    "section": "\n3.2 Running IsoPairFinder and Parameters",
    "text": "3.2 Running IsoPairFinder and Parameters\nThe basic use of IsoPairFinder is simply running the R script as below:\n\n# run the IsoPairFinder workflow\nlibrary(tidyverse)\nlibrary(IsoPairFinder)\n# analysis of HyuA\nfind_intemidates(peak_table_unlabel = 'peak_table_C12.csv',\n                 peak_table_label = 'peak_table_C13.csv',\n                 sample_info = 'sample_info.xlsx',\n                 path = '~/Project/00_Uric_Acid_project/Data/20250606_isopairfind_test/Demo_data_msdial/',\n                 polarity = 'positive',\n                 control_group = c(\"WT\"),\n                 case_group = c('hyuA'),\n                 mz_tol = 10,\n                 rt_tol = 0.05,\n                 p_value_cutoff = 0.05,\n                 p_adjust = TRUE,\n                 fold_change_cutoff = 20,\n                 is_recognize_adducts = TRUE)\n\nThe find_intemidates function is the main function of the IsoPairFinder package, which runs the whole workflow to identify potential intermediates from stable isotope tracing metabolomics data.\nThe parameters are provided below:\n\npeak_table_unlabel: the feature table name of the unlabeled group. The default file name, “peak_table_C12.csv”. See the requirements in Chapter 2.\npeak_table_label: the feature table name of the unlabeled group. The default, “peak_table_C13.csv”. See the requirements in Chapter 2.\nsample_info: the sample information table. See the requirements in Chapter 2.\npath: the working path.\npolarity: ionization polarity, “positive” or “negative”. Default: “positive”\ncontrol_group: the control group, e.g., “WT”. The group names should be included in the sample information table.\ncase_group: the case group, e.g., “hyuA”. The group names should be included in the sample information table.\nmz_tol: m/z tolerance (unit: ppm) for searching the intermediate ions. Default: 10 ppm\nrt_tol: retention time tolerance (unit: minute) for searching the intermediate ions. Default: 0.05 min\np_value_cutoff: the cutoff of p-value (t-test). Default: 0.05\np_adjust: whether to perform the multiple comparison correction (FDR adjustment). Default: TRUE\nfold_change_cutoff: the cutoff of fold-change (case vs. control). Default: 20\nis_recognize_adduct: whether to recognize and merge the isotopes, adducts, and in-source fragments. Default: TRUE",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>IsoPairFinder running</span>"
    ]
  },
  {
    "objectID": "isoPairFinder_running.html#sec-isoPairFinder-output",
    "href": "isoPairFinder_running.html#sec-isoPairFinder-output",
    "title": "3  IsoPairFinder running",
    "section": "\n3.3 Output",
    "text": "3.3 Output\nThe new folder “00_tracer_result” will be generated in the working directory (Figure 1.2), including “tracer_pair_result.xlsx” and several plots in PDF files. Specifically, these files are provided in the result folder:\n\n\ntracer_pair_result.xlsx: This file contains the results from differential analysis, recognized features, and identified substrate feature pairs. It has 4 sheets:\n\n\nraw_data_unlabeled: the differential analysis of the unlabeled group. Some columns below were added to the unlabeled feature table, including p-values, q-values, fold changes, etc.\n\nraw_data_labeled: the differential analysis of the labeled group. Some columns below were added to the unlabeled feature table, including p-values, q-values, fold changes, etc.\n\nrecognized_peak_unlabel: the table of recognized adducts, neutral loss, and in-source fragments (Figure 3.2). The method used here was followed from a previous publication1. Some key column definitions:\n\nbase_peak: the base peaks that are used to recognize the adducts and in-source fragments.\nrelationship: the relationship with the base peak.\nnum_annotation: the number of features that belong to the same group.\ngroup_order: the feature group ID.\n\n\n\npaired_table: the table of possible substrate ion pairs identified. Each row represents one pair of substrate ions (Figure 3.2). Specifically,\n\nunlabeled_feature_id/mz/rt: the property (id, mz, rt) of substrate in the unlabeled group.\nlabled_feature_id/mz/rt: the property (id, mz, rt) of substrate in the labeled group\nmass_shift_label: the estimated carbon number\np_values/fold_changes/average_abundance: the statistics of differential analysis\n\n\n\n\n“volcano_plot_unlabeled.pdf” / “volcano_plot_labeled.pdf”: the volcano plots that show a significant accumulation between the case (mutant) and control groups.\n“isotope_pair_plot_overview.pdf”: the overview of the EIC mirror for identified substrate ion pairs.\n“isotope_pair_list.pdf”: the lists of EIC mirror plots for identified substrate ion pairs.\n“00_intermediate_data”: the intermediate data during processing. It was used for debugging.\n\n\n\n\n\n\nFigure 3.2: The screenshot of the tracer pair result table\n\n\n\n\n\n\n1. \nZhou, Z. et al. Metabolite annotation from knowns to unknowns through knowledge-guided multi-layer metabolic networking. Nature Communications 13, 6656 (2022).",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>IsoPairFinder running</span>"
    ]
  },
  {
    "objectID": "caseStudy.html",
    "href": "caseStudy.html",
    "title": "4  Case Study",
    "section": "",
    "text": "The loss of uricase during hominid evolution has predisposed humans to hyperuricemia and gout, conditions with high global prevalence. In previous work, we identified a uric acid (UA)-inducible gene cluster in Clostridium sporogenes that is required for converting uric acid to short-chain fatty acids (SCFAs)1. When these genes were disrupted, SCFA production was blocked, yet a substantial amount of uric acid was still consumed. This suggested the possibility that pathway intermediates accumulate in the mutants and could be identified by untargeted LC-MS.\nTo investigate this, we developed a stable isotope tracing (STI) metabolomic experiment to detect unknown metabolites produced from uric acid in the anaerobic mutant cultures2. Specifically, for the UA catabolism gene cluster, we curated the 6 mutant strains for each gene. We cultured wild-type and mutant strains of C. sporogenes in the presence of either unlabeled uric acid or its [13C5]-labeled isotopologue. Here, the study of the hyuA gene was used as an example (Figure 4.1).\n\n\n\n\n\n\nFigure 4.1: Study design of STI metabolomics for studying hyuA gene functions\n\n\n\nThe reasonable substrate candidates have a series of characteristics: (i) were elevated in mutant vs. wild-type cultures, (ii) increased in intensity over culture age, and (iii) contained retention-time matched isotopologs when mutants were cultured with [13C5]-labeled uric acid. We processed these STI metabolomics data using IsoPairFinder. Take the hyuA as an example, compared to 190 possible pairs in the unlabeled and labeled groups, IsoPairFinder could significantly narrow the candidate pairs to 7. The final 12C/13C feature pair could be further quickly determined, which further helps propose its possible structure (Figure 4.2).\n\n\n\n\n\n\nFigure 4.2: The identified 12C/13C feature pairs revealing the substrate of the hyuA gene.\n\n\n\n\n\n\n\n1. Liu, Y. et al. A widely distributed gene cluster compensates for uricase loss in hominids. Cell 186, 3400–3413.e20 (2023).\n\n\n2. Liu, Y. et al. Gut bacteria degrade purines via the 2,8-dioxopurine pathway. Nature Microbiology Accepted, (2025).",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Case Study</span>"
    ]
  }
]